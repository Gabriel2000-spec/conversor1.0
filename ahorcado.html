<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Juego del Ahorcado - Ejecutivo</title>
    <style>
        /* Estilo general */
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        h1 {
            color: #f0a500;
            margin-bottom: 0.2em;
            font-weight: 700;
        }

        /* Contenedor principal */
        .container {
            background-color: #1e1e1e;
            border-radius: 10px;
            padding: 20px 30px;
            max-width: 480px;
            width: 100%;
            box-shadow: 0 0 15px #f0a500aa;
        }

        /* Palabra oculta */
        #wordDisplay {
            font-size: 2.5rem;
            letter-spacing: 0.3em;
            margin: 20px 0;
            text-align: center;
            user-select: none;
            font-weight: 700;
        }

        /* Input para agregar palabra */
        #newWordInput {
            width: calc(100% - 110px);
            padding: 8px 10px;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            margin-right: 10px;
        }

        button {
            background-color: #f0a500;
            border: none;
            padding: 10px 18px;
            border-radius: 5px;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease;
            color: #121212;
        }

        button:hover {
            background-color: #cf8e00;
        }

        /* Letras usadas */
        #usedLetters {
            margin-top: 15px;
            font-size: 1.2rem;
            letter-spacing: 0.15em;
            min-height: 30px;
        }

        /* Monedas */
        #coinsContainer {
            margin-top: 30px;
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 700;
            user-select: none;
            position: relative;
            height: 50px;
        }

        #coinCount {
            margin-left: 10px;
            color: #f0a500;
        }

        /* Icono moneda SVG */
        .coin-icon {
            width: 32px;
            height: 32px;
            fill: #f0a500;
        }

        /* Animación monedas brincando */
        .coin-jump {
            position: absolute;
            bottom: 0;
            width: 30px;
            height: 30px;
            animation: jump 8.8s ease forwards;
            pointer-events: none;
            z-index: 10;
            fill: #f0a500;
            filter: drop-shadow(0 0 3px #f0a500);
        }

        @keyframes jump {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            50% {
                transform: translateY(-60px) scale(1.3);
                opacity: 1;
            }
            100% {
                transform: translateY(0) scale(1);
                opacity: 0;
            }
        }

        /* Estado juego */
        #statusMessage {
            margin-top: 20px;
            font-size: 1.3rem;
            font-weight: 700;
            text-align: center;
            min-height: 30px;
        }

        /* Input letra */
        #letterInput {
            width: 100%;
            font-size: 1.5rem;
            padding: 8px 10px;
            border-radius: 5px;
            border: none;
            margin-top: 15px;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            background-color: #2a2a2a;
            color: #e0e0e0;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <h1>Juego del Ahorcado</h1>
    <div class="container">
        <div>
            <label for="newWordInput" style="font-weight:700;">Agregar palabra:</label>
            
            <br>
            <br>
            
            <input type="text" id="newWordInput" maxlength="15" placeholder="Nueva palabra" />
            
            <br>
            <br>
            
            <button id="addWordBtn" title="Agregar palabra para jugar">Agregar</button>
        </div>

        <div id="wordDisplay" aria-live="polite" aria-atomic="true">_ _ _ _ _</div>

        <input type="text" id="letterInput" maxlength="1" autocomplete="off" placeholder="Ingrese una letra" aria-label="Ingresar letra para adivinar" />


        <div id="usedLetters" aria-live="polite" aria-atomic="true">Letras usadas: </div>

        <div id="statusMessage" role="alert"></div>

        <div id="coinsContainer" aria-label="Monedas ganadas">
            <svg class="coin-icon" viewBox="0 0 64 64" aria-hidden="true" focusable="false">
                <circle cx="32" cy="32" r="30" stroke="#f0a500" stroke-width="4" fill="#f0a500"/>
                <text x="32" y="40" text-anchor="middle" font-size="28" fill="#121212" font-weight="700">$</text>
            </svg>
            <span id="coinCount">0</span>
        </div>
    </div>

    <script>
        (() => {
            const wordDisplay = document.getElementById('wordDisplay');
            const letterInput = document.getElementById('letterInput');
            const usedLettersDisplay = document.getElementById('usedLetters');
            const statusMessage = document.getElementById('statusMessage');
            const coinCountSpan = document.getElementById('coinCount');
            const coinsContainer = document.getElementById('coinsContainer');
            const newWordInput = document.getElementById('newWordInput');
            const addWordBtn = document.getElementById('addWordBtn');

            // Estado del juego
            let words = [];
            let currentWord = '';
            let guessedLetters = new Set();
            let correctLetters = new Set();
            let maxErrors = 6;
            let errors = 0;
            let coins = 0;

            // Guardar y cargar desde localStorage
            function saveState() {
                localStorage.setItem('ahorcado_words', JSON.stringify(words));
                localStorage.setItem('ahorcado_coins', coins);
            }

            function loadState() {
                const storedWords = JSON.parse(localStorage.getItem('ahorcado_words'));
                if (Array.isArray(storedWords) && storedWords.length > 0) {
                    words = storedWords;
                } else {
                    // Palabras por defecto
                    words = ['AREPA', 'ARAGUANEY', 'CHAMO', 'ORINOCO', 'ANGOSTURA', 'CACHAPA', 'GUAYOYO'];
                }

                const storedCoins = parseInt(localStorage.getItem('ahorcado_coins'));
                coins = isNaN(storedCoins) ? 0 : storedCoins;
                coinCountSpan.textContent = coins;
            }

            // Escoger palabra aleatoria
            function selectWord() {
                const idx = Math.floor(Math.random() * words.length);
                currentWord = words[idx].toUpperCase();
            }

            // Mostrar palabra oculta
            function displayWord() {
                let display = '';
                for (const ch of currentWord) {
                    if (correctLetters.has(ch)) {
                        display += ch + ' ';
                    } else if (ch === ' ') {
                        display += '  ';
                    } else {
                        display += '_ ';
                    }
                }
                wordDisplay.textContent = display.trim();
            }

            // Actualizar letras usadas
            function displayUsedLetters() {
                if (guessedLetters.size === 0) {
                    usedLettersDisplay.textContent = 'Letras usadas: ';
                } else {
                    usedLettersDisplay.textContent = 'Letras usadas: ' + Array.from(guessedLetters).sort().join(' ');
                }
            }

            // Comprobar si ganó
            function checkWin() {
                for (const ch of currentWord) {
                    if (ch !== ' ' && !correctLetters.has(ch)) {
                        return false;
                    }
                }
                return true;
            }

            // Mostrar monedas brincando
            function coinJumpEffect() {
                const jumpCount = 8;
                for (let i = 0; i < jumpCount; i++) {
                    const coin = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                    coin.setAttribute('viewBox', '0 0 64 64');
                    coin.classList.add('coin-jump');
                    coin.style.left = (i * 30 + 10) + 'px';
                    coin.style.bottom = '0px';
                    coin.style.position = 'absolute';
                    coin.style.fill = '#f0a500';
                    coin.style.width = '24px';
                    coin.style.height = '24px';

                    const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                    circle.setAttribute('cx', '32');
                    circle.setAttribute('cy', '32');
                    circle.setAttribute('r', '30');
                    circle.setAttribute('stroke', '#f0a500');
                    circle.setAttribute('stroke-width', '4');
                    circle.setAttribute('fill', '#f0a500');

                    const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    text.setAttribute('x', '32');
                    text.setAttribute('y', '40');
                    text.setAttribute('text-anchor', 'middle');
                    text.setAttribute('font-size', '28');
                    text.setAttribute('fill', '#121212');
                    text.setAttribute('font-weight', '700');
                    text.textContent = '$';

                    coin.appendChild(circle);
                    coin.appendChild(text);

                    coinsContainer.appendChild(coin);

                    // Remover después de animar
                    coin.addEventListener('animationend', () => {
                        coin.remove();
                    });
                }
            }

            // Reiniciar juego
            function resetGame() {
                guessedLetters.clear();
                correctLetters.clear();
                errors = 0;
                statusMessage.textContent = '';
                selectWord();
                displayWord();
                displayUsedLetters();
                letterInput.value = '';
                letterInput.disabled = false;
                letterInput.focus();
            }

            // Manejar ingreso de letra
            function handleLetterInput(e) {
                const letter = e.target.value.toUpperCase();
                e.target.value = '';

                if (!letter.match(/^[A-ZÑ]$/)) {
                    statusMessage.textContent = 'Ingrese solo una letra válida (A-Z, Ñ).';
                    return;
                }

                if (guessedLetters.has(letter)) {
                    statusMessage.textContent = `Ya usaste la letra "${letter}". Intenta otra.`;
                    return;
                }

                guessedLetters.add(letter);

                if (currentWord.includes(letter)) {
                    correctLetters.add(letter);
                    displayWord();
                    statusMessage.textContent = `¡Bien! La letra "${letter}" está en la palabra.`;

                    if (checkWin()) {
                        coins += 10;
                        coinCountSpan.textContent = coins;
                        saveState();
                        statusMessage.textContent = `¡Felicidades! Ganaste 10 monedas.`;
                        letterInput.disabled = true;
                        coinJumpEffect();
                    }
                } else {
                    errors++;
                    statusMessage.textContent = `La letra "${letter}" no está en la palabra. Errores: ${errors} de ${maxErrors}`;

                    if (errors >= maxErrors) {
                        statusMessage.textContent = `Juego terminado. La palabra era: ${currentWord}`;
                        displayWord(); // Mostrar palabra completa
                        letterInput.disabled = true;
                    }
                }

                displayUsedLetters();
            }

            // Agregar nueva palabra
            function addWord() {
                const newWord = newWordInput.value.trim().toUpperCase();
                if (!newWord.match(/^[A-ZÑ\s]{2,15}$/)) {
                    alert('Ingrese una palabra válida (solo letras A-Z y espacios, 2 a 15 caracteres).');
                    return;
                }

                if (words.includes(newWord)) {
                    alert('La palabra ya existe.');
                    return;
                }

                words.push(newWord);
                saveState();
                newWordInput.value = '';
                alert(`Palabra "${newWord}" agregada. Comienza un nuevo juego.`);
                resetGame();
            }

            // Eventos
            letterInput.addEventListener('input', handleLetterInput);
            addWordBtn.addEventListener('click', addWord);
            newWordInput.addEventListener('keypress', e => {
                if (e.key === 'Enter') {
                    addWord();
                }
            });

            // Inicialización
            loadState();
            resetGame();
        })();
    </script>
</body>
</html>
